<!-- 文章管理 -->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>博客后台管理</title>
	
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" href="../assets/materialize/css/materialize.min.css" media="screen,projection" />
    <!-- Bootstrap Styles-->
    <link href="../assets/css/bootstrap.css" rel="stylesheet" />
    <!-- FontAwesome Styles-->
    <link href="../assets/css/font-awesome.css" rel="stylesheet" />
    <!-- Morris Chart Styles-->
    <link href="../assets/js/morris/morris-0.4.3.min.css" rel="stylesheet" />
    <!-- Custom Styles-->
    <link href="../assets/css/custom-styles.css" rel="stylesheet" />
    <!-- Google Fonts-->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
    <link rel="stylesheet" href="../assets/js/Lightweight-Chart/cssCharts.css"> 
</head>

<body>
    <div id="wrapper">
        <nav class="navbar navbar-default top-navbar" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle waves-effect waves-dark" data-toggle="collapse" data-target=".sidebar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand waves-effect waves-dark" href="index.html"><i class="large material-icons">insert_chart</i> <strong>后台管理</strong></a>
				
		<div id="sideNav" href=""><i class="material-icons dp48">toc</i></div>
            </div>

            <ul class="nav navbar-top-links navbar-right"> 
				  <li><a class="dropdown-button waves-effect waves-dark" href="#!" data-activates="dropdown1"><i class="fa fa-user fa-fw"></i> <b id="username"></b> <i class="material-icons right">arrow_drop_down</i></a></li>
            </ul>
        </nav>
		<!-- Dropdown Structure -->
<ul id="dropdown1" class="dropdown-content">
<li><a href="personalInfo.html"><i class="fa fa-user fa-fw"></i>个人信息</a>
</li>
<li><a href="setting.html"><i class="fa fa-gear fa-fw"></i> 设置</a>
</li> 
<li><a href="/logout"><i class="fa fa-sign-out fa-fw"></i> 注销</a>
</li>
</ul>


	   <!--/. NAV TOP  -->
        <nav class="navbar-default navbar-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav" id="main-menu">

                    <li>
                        <a href="index.html"><i class="fa fa-dashboard"></i>数据统计</a>
                    </li>
                    <li>
                        <a class="active-menu waves-effect waves-dark" href="articleMgr.html" class="waves-effect waves-dark"><i class="fa fa-desktop"></i>文章管理</a>
                    </li>
					<li>
                        <a href="commentMgr.html" class="waves-effect waves-dark"><i class="fa fa-bar-chart-o"></i> 评论管理</a>
                    </li>
                </ul>

            </div>

        </nav>
        <!-- /. NAV SIDE  -->
      
		<div id="page-wrapper">
		  <div class="header"> 
                        <h1 class="page-header">
                            文章管理
                        </h1>
						<ol class="breadcrumb">
					  <li><a href="#">后台</a></li>
					  <li><a href="#">文章管理</a></li>
					  <li class="active">数据</li>
					</ol> 
									
		</div>
            <div id="page-inner">

			
                <div class="row">
                <div class="col-md-12">
                    <!-- Advanced Tables -->
                    <div class="card">
                        <div class="card-action">
                             文章列表
                        </div>
                        <div class="card-content">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                                    <thead>
                                        <tr>
                                            <th class="center">标题</th>
                                            <th class="center" class="center">发表日期</th>
                                            <th class="center">浏览量</th>
                                            <th class="center">评论量</th>
                                            <th style="text-align: center; width: 20%">操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="data_body">
                                        <!-- <tr class="gradeX">
                                            <td>Misc</td>
                                            <td>2016-12-26</td>
                                            <td>我是大煞笔</td>
                                            <td class="center">5000</td>
                                            <td class="center"><button class="btn btn-success">查看</button>&nbsp;<button class="btn btn-info">修改</button>&nbsp;<button class="btn btn-danger">删除</button></td>
                                        </tr>
                                        <tr class="gradeX">
                                            <td>Misc</td>
                                            <td>2016-12-26</td>
                                            <td>你是大煞笔</td>
                                            <td class="center">20000</td>
                                            <td class="center"><button class="btn btn-success">查看</button>&nbsp;<button class="btn btn-info">修改</button>&nbsp;<button class="btn btn-danger">删除</button></td>
                                        </tr>
                                        <tr class="gradeX">
                                            <td>Misc</td>
                                            <td>2016-12-26</td>
                                            <td>他是大煞笔</td>
                                            <td class="center">0</td>
                                            <td class="center"><button class="btn btn-success">查看</button>&nbsp;<button class="btn btn-info">修改</button>&nbsp;<button class="btn btn-danger">删除</button></td>
                                        </tr>
                                        <tr class="gradeX">
                                            <td>Misc</td>
                                            <td>2016-12-26</td>
                                            <td>她是大煞笔</td>
                                            <td class="center">100</td>
                                            <td class="center"><button class="btn btn-success">查看</button>&nbsp;<button class="btn btn-info">修改</button>&nbsp;<button class="btn btn-danger">删除</button></td>
                                        </tr> -->
                                    </tbody>
                                </table>
                            </div>
                            
                        </div>
                    </div>
                    <!--End Advanced Tables -->
                </div>
            </div>
                <!-- /. ROW  -->
			

			   <div class="fixed-action-btn horizontal click-to-toggle">
    <a class="btn-floating btn-large red">
      <i class="material-icons">menu</i>
    </a>
    <ul>
      <li><a class="btn-floating red" title="写博客" href="write.html"><i class="material-icons">mode_edit</i></a></li>
      <li><a class="btn-floating green" id="re_top" title="返回顶部"><i class="material-icons">publish</i></a></li>
      <li><a class="btn-floating yellow" title="修改密码" href="updatePwd.html"><i class="material-icons">lock_outline</i></a></li>
      <li><a class="btn-floating blue" title="注销" href="/logout"><i class="material-icons">power_settings_new</i></a></li>
    </ul>
  </div>
            </div>
            <!-- /. PAGE INNER  -->
        </div>
        <!-- /. PAGE WRAPPER  -->
    </div>
    <!-- /. WRAPPER  -->
    <!-- JS Scripts-->
    <!-- jQuery Js -->
    <script src="../assets/js/jquery-1.10.2.js"></script>
	<script src="../resources/js/admin_root.js"></script>
	<!-- Bootstrap Js -->
    <script src="../assets/js/bootstrap.min.js"></script>
	
	<script src="../assets/materialize/js/materialize.min.js"></script>
	
    <!-- Metis Menu Js -->
    <script src="../assets/js/jquery.metisMenu.js"></script>
    <!-- Morris Chart Js -->
    <script src="../assets/js/morris/raphael-2.1.0.min.js"></script>
    <script src="../assets/js/morris/morris.js"></script>
	
	
	<script src="../assets/js/easypiechart.js"></script>
	<script src="../assets/js/easypiechart-data.js"></script>
	
	 <script src="../assets/js/Lightweight-Chart/jquery.chart.js"></script>
	<!-- DATA TABLE SCRIPTS -->
    <script src="../assets/js/dataTables/jquery.dataTables.js"></script>
    <script src="../assets/js/dataTables/dataTables.bootstrap.js"></script>
    <script type="text/javascript">
        function myrefresh(){
           window.location.reload();
        }
        //删除操作
        function article_delete(id){
            var r=confirm("确认删除吗？");
            if (r==true){
                $.ajax({
                    url: '/article/delete',
                    type:'POST',
                    data:{
                        articleId: id,
                    },
                    success: function (data) {
                      if (data.status == "ok") {
                        alert('删除成功！');
                        myrefresh();
                      }
                        // alert(data);
                    }
                })
            }
        }
        //修改操作
        function article_update(id){
            var url = "/admin/write.html?id="+id;
            window.location=url;
        }
    </script>
<script>
    function showData(){
        $('#dataTables-example').dataTable({
            serverSide: true,//分页，取数据等等的都放到服务端去
            processing: true,//载入数据的时候是否显示“载入中”
            pageLength: 10,//首次加载的数据条数
            ordering: false,//排序操作在服务端进行，所以可以关了。
            ajax: {//类似jquery的ajax参数，基本都可以用。
                data: function (d) {//d 是原始的发送给服务器的数据，默认很长。
                    console.log(d);
                    var param = {
                        currPage : d.start,
                        pageSize : d.length,
                        order : '',
                        orderBy : '',
                        totalCount : '',
                        totalPage : ''
                    };//因为服务端排序，可以新建一个参数对象
                    param.currPage = d.start;//开始的序号
                    param.pageSize = d.length;//要取的数据的
                    return param;//自定义需要传递的参数。
                },
                dataSrc: function (json) {
                    return json.data.list;
                },//默认data，也可以写其他的，格式化table的时候取里面的数据
                type: "post",//后台指定了方式，默认get，外加datatable默认构造的参数很长，有可能超过get的最大长度。
                url: "/article/pagelist",
                success: function(data){
                    console.log(data);
                    var html = '';
                    for(var i = 0; i<data.data.list.length; i++){
                        html = '<tr class="gradeX"><td class="center">'+data.data.list[i]['title']+'</td><td class="center">'+data.data.list[i]['createTime']+'</td><td class="center">'+data.data.list[i]['pageView']+'</td><td class="center">'+data.data.list[i]['commentNum']+'</td><td class="center"><button class="btn btn-info" onclick="article_update(\''+data.data.list[i]['id']+'\')">修改</button>&nbsp;<button class="btn btn-danger" onclick="article_delete(\''+data.data.list[i]['id']+'\')">删除</button></td></tr>' + html;
                    }
                    
                    $('#data_body').html(html);
                    console.log(data);
                    console.log(data['data']['list']);
                    $('#dataTables-example_processing').hide();
                }
            },
            // columns: [//对应上面thead里面的序列
            //     { 
            //       data: "id", 
            //     },//字段名字和返回的json序列的key对应
            //     { 
            //       data: "brief", 
            //     },
            //     { 
            //       data: "brief", 
            //     },
            //     { data: "discriminator", },
            //     {
            //         data: function (e) {//这里给最后一列返回一个操作列表
            //             console.log(e);
            //             //e是得到的json数组中的一个item ，可以用于控制标签的属性。
            //             return e;
            //         }
            //     }
            // ],
        });
    }
    $(document).ready(function () {
        showData();
    });
</script>
    <!-- Custom Js -->
    <script src="../assets/js/custom-scripts.js"></script> 
 
    
</body>

</html>